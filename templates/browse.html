{% extends "base.html" %}
{% block content %}

<nav aria-label="breadcrumb" class="mb-3">
  <ol class="breadcrumb flex-wrap bg-white p-2 shadow-sm rounded">
    <li class="breadcrumb-item"><a href="/browse">Root</a></li>
    {% set cumulative = "" %}
    {% for part in breadcrumb %}
      {% set cumulative = cumulative + ("/" if cumulative else "") + part %}
      {% if not loop.last %}
        <li class="breadcrumb-item"><a href="/browse?path={{ cumulative }}">{{ part }}</a></li>
      {% else %}
        <li class="breadcrumb-item active" aria-current="page">{{ part }}</li>
      {% endif %}
    {% endfor %}
  </ol>
</nav>

<div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">
  <h6 class="text-secondary path-display" title="{{ abs_path }}">{{ abs_path }}</h6>
  <form class="d-flex mt-2 mt-sm-0" onsubmit="searchFiles(event)">
    <input id="searchBox" class="form-control form-control-sm me-2" type="search" placeholder="ê²€ìƒ‰..." aria-label="Search">
    <button class="btn btn-outline-primary btn-sm">ê²€ìƒ‰</button>
  </form>
</div>

<div class="table-responsive">
  <table id="fileTable" class="table table-striped table-hover align-middle">
    <thead class="table-dark">
      <tr>
        <th onclick="sortTable(0)">ì´ë¦„ â¬</th>
        <th onclick="sortTable(1)">ìœ í˜•</th>
        <th onclick="sortTable(2)">í¬ê¸°</th>
        <th onclick="sortTable(3)">ìˆ˜ì •ì¼</th>
        <th>ë™ì‘</th>
      </tr>
    </thead>
    <tbody>
      {% for e in entries %}
      <tr>
        <td>
          {% if e.is_dir %}
            ğŸ“ <a href="/browse?path={{ e.path }}">{{ e.name }}</a>
          {% else %}
            ğŸ“„ {{ e.name }}
          {% endif %}
        </td>
        <td>{{ 'í´ë”' if e.is_dir else 'íŒŒì¼' }}</td>
        <td>{{ e.size }}</td>
        <td>{{ e.mtime | int | datetimeformat }}</td>
        <td>
          {% if not e.is_dir %}
          <a class="btn btn-sm btn-outline-primary" href="/download?path={{ e.path }}">â¬‡</a>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<hr>
<form action="/upload?path={{ path }}" method="post" enctype="multipart/form-data" class="mt-3">
  <div class="input-group">
    <input type="file" name="file" class="form-control" required>
    <button class="btn btn-success">ğŸ“¤ ì—…ë¡œë“œ</button>
  </div>
</form>

{% endblock %}
